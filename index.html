<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" >
<meta name="viewport" content="width=device-width,initial-scale=1" >
<title>Lions Gate Portal ‚Äî Calling Points System</title>
<meta name="description" content="Lions Gate Calling Points Portal ‚Äî secure a video call session. Interactive scheduling with confirmation and email flow." >
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Archivo:wght@600;700;900&family=JetBrains+Mono:wght@400;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
:root {
  --bg-dark: #0a0e17;
  --bg-mid: #131821;
  --card-dark: #1a1f2e;
  --card-light: #222936;
  --accent-gold: #f4d03f;
  --accent-gold-dim: #c9a842;
  --accent-blue: #4a9eff;
  --accent-purple: #a78bfa;
  --text-primary: #e8edf5;
  --text-secondary: #8b95a8;
  --text-muted: #5d6679;
  --success-bg: rgba(16, 185, 129, 0.1);
  --success-border: rgba(16, 185, 129, 0.3);
  --success-text: #10b981;
  --error-bg: rgba(239, 68, 68, 0.1);
  --error-border: rgba(239, 68, 68, 0.3);
  --error-text: #ef4444;
  --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
}

@media (prefers-color-scheme: light) {
  :root {
    --bg-dark: #f8f9fc;
    --bg-mid: #ffffff;
    --card-dark: #ffffff;
    --card-light: #f3f4f7;
    --accent-gold: #d4a11d;
    --accent-gold-dim: #b8901a;
    --accent-blue: #2563eb;
    --accent-purple: #7c3aed;
    --text-primary: #1f2937;
    --text-secondary: #4b5563;
    --text-muted: #6b7280;
    --success-bg: rgba(16, 185, 129, 0.08);
    --success-border: rgba(16, 185, 129, 0.25);
    --success-text: #059669;
    --error-bg: rgba(239, 68, 68, 0.08);
    --error-border: rgba(239, 68, 68, 0.25);
    --error-text: #dc2626;
  }
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: var(--bg-dark);
  color: var(--text-primary);
  min-height: 100vh;
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  overflow-x: hidden;
}

.background-pattern {
  position: fixed;
  inset: 0;
  z-index: 0;
  opacity: 0.03;
  background-image:
    radial-gradient(circle at 20% 30%, var(--accent-purple) 0%, transparent 50%),
    radial-gradient(circle at 80% 70%, var(--accent-blue) 0%, transparent 50%),
    radial-gradient(circle at 50% 50%, var(--accent-gold) 0%, transparent 70%);
  pointer-events: none;
}

.container {
  position: relative;
  z-index: 1;
  max-width: 1200px;
  margin: 0 auto;
  padding: clamp(20px, 5vw, 48px);
}

/* Header Styles */
.header {
  display: flex;
  align-items: center;
  gap: 20px;
  margin-bottom: 40px;
  animation: slideDown 0.6s ease-out;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.logo {
  width: 72px;
  height: 72px;
  border-radius: 16px;
  background: linear-gradient(135deg, #2d1b4e 0%, #1a1a2e 50%, #3d2817 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: 'Archivo', sans-serif;
  font-weight: 900;
  font-size: 24px;
  color: var(--accent-gold);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  position: relative;
  overflow: hidden;
}

.logo::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
  transform: translateX(-100%);
  animation: shimmer 3s infinite;
}

@keyframes shimmer {
  100% {
    transform: translateX(100%);
  }
}

.header-meta h1 {
  font-family: 'Archivo', sans-serif;
  font-weight: 700;
  font-size: clamp(20px, 4vw, 28px);
  letter-spacing: -0.02em;
  margin-bottom: 4px;
}

.header-meta p {
  color: var(--text-secondary);
  font-size: 14px;
}

/* Hero Section */
.hero {
  background: linear-gradient(135deg, var(--card-dark) 0%, var(--card-light) 100%);
  border-radius: 20px;
  padding: clamp(24px, 5vw, 40px);
  margin-bottom: 40px;
  position: relative;
  overflow: hidden;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
  animation: fadeInUp 0.8s ease-out 0.2s both;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.hero::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, var(--accent-gold), var(--accent-purple), var(--accent-blue));
}

.hero-content {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 32px;
  flex-wrap: wrap;
}

.hero-left {
  flex: 1;
  min-width: 280px;
}

.hero-left h2 {
  font-family: 'Archivo', sans-serif;
  font-weight: 700;
  font-size: clamp(24px, 5vw, 32px);
  margin-bottom: 12px;
  letter-spacing: -0.03em;
}

.hero-left p {
  color: var(--text-secondary);
  font-size: 15px;
  margin-bottom: 16px;
}

.badge {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 18px;
  background: rgba(244, 208, 63, 0.1);
  border: 1px solid rgba(244, 208, 63, 0.2);
  border-radius: 100px;
  color: var(--accent-gold);
  font-size: 13px;
  font-weight: 600;
}

.badge::before {
  content: 'üîí';
  font-size: 14px;
}

.closing-widget {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(185, 28, 28, 0.1));
  border: 1px solid rgba(239, 68, 68, 0.3);
  padding: 20px 28px;
  border-radius: 16px;
  text-align: center;
  min-width: 220px;
  box-shadow: 0 8px 24px rgba(239, 68, 68, 0.15);
}

.closing-label {
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text-secondary);
  margin-bottom: 8px;
  font-weight: 600;
}

.closing-time {
  font-family: 'JetBrains Mono', monospace;
  font-size: 24px;
  font-weight: 600;
  color: var(--accent-gold);
}

/* Pricing Grid */
.pricing-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
  margin-bottom: 40px;
}

.pricing-card {
  background: linear-gradient(135deg, var(--card-dark), var(--card-light));
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 16px;
  padding: 24px;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  animation: fadeInUp 0.6s ease-out both;
}

.pricing-card:nth-child(1) { animation-delay: 0.1s; }
.pricing-card:nth-child(2) { animation-delay: 0.15s; }
.pricing-card:nth-child(3) { animation-delay: 0.2s; }
.pricing-card:nth-child(4) { animation-delay: 0.25s; }
.pricing-card:nth-child(5) { animation-delay: 0.3s; }
.pricing-card:nth-child(6) { animation-delay: 0.35s; }
.pricing-card:nth-child(7) { animation-delay: 0.4s; }
.pricing-card:nth-child(8) { animation-delay: 0.45s; }
.pricing-card:nth-child(9) { animation-delay: 0.5s; }
.pricing-card:nth-child(10) { animation-delay: 0.55s; }

.pricing-card::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(74, 158, 255, 0.1), transparent);
  opacity: 0;
  transition: opacity 0.3s;
}

.pricing-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  border-color: rgba(244, 208, 63, 0.3);
}

.pricing-card:hover::before {
  opacity: 1;
}

.pricing-card:active {
  transform: translateY(-4px);
}

.pricing-amount {
  font-family: 'Archivo', sans-serif;
  font-size: 36px;
  font-weight: 900;
  color: var(--accent-gold);
  margin-bottom: 8px;
}

.pricing-duration {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 8px;
  color: var(--text-primary);
}

.pricing-desc {
  font-size: 13px;
  color: var(--text-muted);
}

.pricing-card.featured {
  background: linear-gradient(135deg, rgba(74, 158, 255, 0.15), rgba(167, 139, 250, 0.1));
  border: 2px solid var(--accent-blue);
  position: relative;
}

.featured-badge {
  position: absolute;
  top: 12px;
  right: 12px;
  background: var(--accent-blue);
  color: white;
  font-size: 11px;
  font-weight: 700;
  padding: 4px 12px;
  border-radius: 100px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Modal Styles */
.modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.75);
  backdrop-filter: blur(4px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  padding: 20px;
  animation: fadeIn 0.3s ease-out;
}

.modal-backdrop.active {
  display: flex;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.modal {
  background: linear-gradient(135deg, var(--card-dark), var(--bg-mid));
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 24px;
  padding: 32px;
  max-width: 600px;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 40px 100px rgba(0, 0, 0, 0.5);
  animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(40px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.modal h3 {
  font-family: 'Archivo', sans-serif;
  font-size: 24px;
  font-weight: 700;
  margin-bottom: 8px;
  color: var(--accent-gold);
}

.modal p {
  color: var(--text-secondary);
  margin-bottom: 16px;
  font-size: 14px;
}

.modal label {
  display: block;
  font-size: 13px;
  font-weight: 600;
  color: var(--text-secondary);
  margin-bottom: 8px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.hash-display {
  font-family: 'JetBrains Mono', monospace;
  background: linear-gradient(135deg, var(--bg-mid), var(--bg-dark));
  border: 2px dashed rgba(244, 208, 63, 0.3);
  padding: 16px;
  border-radius: 12px;
  color: var(--accent-gold);
  font-size: 16px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s;
  user-select: all;
  margin-bottom: 20px;
  position: relative;
}

.hash-display:hover {
  border-color: var(--accent-gold);
  background: linear-gradient(135deg, var(--bg-dark), var(--bg-mid));
}

.hash-display::after {
  content: 'üìã Click to copy';
  position: absolute;
  top: -8px;
  right: 12px;
  background: var(--card-dark);
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 11px;
  color: var(--text-muted);
  opacity: 0;
  transition: opacity 0.2s;
}

.hash-display:hover::after {
  opacity: 1;
}

/* Button Styles */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 12px 24px;
  border: none;
  border-radius: 10px;
  font-family: 'Inter', sans-serif;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  text-decoration: none;
}

.btn-primary {
  background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
  color: white;
  box-shadow: 0 4px 16px rgba(74, 158, 255, 0.3);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(74, 158, 255, 0.4);
}

.btn-primary:active {
  transform: translateY(0);
}

.btn-secondary {
  background: transparent;
  border: 1px solid rgba(255, 255, 255, 0.15);
  color: var(--text-secondary);
}

.btn-secondary:hover {
  background: rgba(255, 255, 255, 0.05);
  border-color: rgba(255, 255, 255, 0.25);
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

.modal-actions {
  display: flex;
  gap: 12px;
  margin-top: 24px;
  flex-wrap: wrap;
}

/* Alert Styles */
.alert {
  padding: 16px;
  border-radius: 12px;
  margin-top: 16px;
  font-size: 14px;
  display: flex;
  align-items: start;
  gap: 12px;
}

.alert-success {
  background: var(--success-bg);
  border: 1px solid var(--success-border);
  color: var(--success-text);
}

.alert-error {
  background: var(--error-bg);
  border: 1px solid var(--error-border);
  color: var(--error-text);
}

.alert-icon {
  font-size: 20px;
  flex-shrink: 0;
}

/* Session Details */
.session-details {
  background: linear-gradient(135deg, rgba(74, 158, 255, 0.08), rgba(167, 139, 250, 0.05));
  border: 1px solid rgba(74, 158, 255, 0.2);
  border-radius: 16px;
  padding: 24px;
  margin-bottom: 32px;
  animation: fadeInUp 0.6s ease-out;
}

.session-details h4 {
  font-family: 'Archivo', sans-serif;
  font-size: 20px;
  font-weight: 700;
  margin-bottom: 20px;
  color: var(--accent-gold);
}

.detail-row {
  display: flex;
  justify-content: space-between;
  padding: 12px 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.06);
}

.detail-row:last-child {
  border-bottom: none;
}

.detail-label {
  font-weight: 600;
  color: var(--text-secondary);
  font-size: 14px;
}

.detail-value {
  color: var(--text-primary);
  font-weight: 500;
  font-size: 14px;
  text-align: right;
}

.detail-value.mono {
  font-family: 'JetBrains Mono', monospace;
  font-size: 13px;
  color: var(--accent-gold);
}

/* Footer */
.footer {
  margin-top: 48px;
  padding-top: 24px;
  border-top: 1px solid rgba(255, 255, 255, 0.06);
  text-align: center;
  color: var(--text-muted);
  font-size: 13px;
}

.footer strong {
  color: var(--text-secondary);
}

.footer-notice {
  margin-top: 24px;
  padding: 16px;
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.12), rgba(185, 28, 28, 0.08));
  border: 1px solid rgba(239, 68, 68, 0.25);
  border-radius: 12px;
  font-size: 14px;
  line-height: 1.6;
}

.footer-notice strong {
  color: var(--error-text);
}

/* Responsive */
@media (max-width: 768px) {
  .hero-content {
    flex-direction: column;
    align-items: stretch;
  }

  .countdown-widget {
    min-width: auto;
  }

  .pricing-grid {
    grid-template-columns: 1fr;
  }

  .modal {
    padding: 24px;
    margin: 16px;
  }

  .modal-actions {
    flex-direction: column;
  }

  .btn {
    width: 100%;
  }
}

/* Scrollbar styling */
::-webkit-scrollbar {
  width: 10px;
}

::-webkit-scrollbar-track {
  background: var(--bg-dark);
}

::-webkit-scrollbar-thumb {
  background: var(--card-light);
  border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--accent-gold-dim);
}
</style>
</head>
<body>
<div class="background-pattern"></div>

<div class="container">
  <header class="header">
    <div class="logo" aria-label="Lions Gate Portal Logo">LG</div>
    <div class="header-meta">
      <h1>Lions Gate Portal ‚Äî Calling Points System</h1>
      <p>Official Lions Gate Fan Portal ‚Äî Schedule your video call session</p>
    </div>
  </header>

  <section class="hero">
    <div class="hero-content">
      <div class="hero-left">
        <h2>Secure a Video Session ‚Äî Confirm & Schedule</h2>
        <p>Select a package below. Click the $120 option to confirm and schedule directly inside the portal.</p>
        <div class="badge">Privacy option adds $30 for encrypted communication</div>
      </div>
      <div class="closing-widget">
        <div class="closing-label">Portal Closes</div>
        <div class="closing-time">11:00 AM EST</div>
      </div>
    </div>
  </section>

  <div id="sessionDetailsContainer"></div>

  <div class="pricing-grid" id="pricingGrid"></div>

  <footer class="footer">
    Receiving Zelle: <strong>joancdy@gmail.com</strong> ‚Ä¢ Joan Luiser ‚Ä¢ +1 (352) 805-8317
  </footer>
</div>

<div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true">
  <div class="modal" id="modalContent"></div>
</div>

<script>
// --- Configuration & State (in-memory, no localStorage) ---
const APP_STATE = {
  confirmedSession: null,
  currentHash: null
};

const PRICING_TIERS = [
  { amount: 70, duration: '10 seconds', desc: 'Dec 21-23 public fan session' },
  { amount: 120, duration: '30 seconds', desc: 'Dec 8-11 public fan session', featured: true },
  { amount: 150, duration: '60 seconds', desc: 'One minute session' },
  { amount: 180, duration: '90 seconds', desc: 'One and a half minute session' },
  { amount: 200, duration: '2 minutes', desc: 'Short conversation' },
  { amount: 300, duration: '5 minutes', desc: 'Five minute chat' },
  { amount: 400, duration: '10 minutes', desc: 'Longer engagement' },
  { amount: 500, duration: '15 minutes', desc: 'Extended session' },
  { amount: 700, duration: '20 minutes', desc: 'Premium session' },
  { amount: 1000, duration: '30 minutes', desc: 'VIP private session' }
];

// --- DOM Elements ---
const pricingGrid = document.getElementById('pricingGrid');
const modalBackdrop = document.getElementById('modalBackdrop');
const modalContent = document.getElementById('modalContent');
const sessionDetailsContainer = document.getElementById('sessionDetailsContainer');

// --- Utility Functions ---
function generateSessionHash() {
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
  const randomPart = Array.from({ length: 8 }, () => chars[Math.floor(Math.random() * chars.length)]).join('');
  const timestamp = Date.now().toString().slice(-5);
  return `LG-${randomPart}-${timestamp}`;
}

async function copyToClipboard(text) {
  try {
    await navigator.clipboard.writeText(text);
    return true;
  } catch (err) {
    console.error('Failed to copy:', err);
    return false;
  }
}

function showModal(content) {
  modalContent.innerHTML = content;
  modalBackdrop.classList.add('active');
  document.body.style.overflow = 'hidden';
}

function closeModal() {
  modalBackdrop.classList.remove('active');
  document.body.style.overflow = '';
}

function generateGmailLink(details) {
  const to = 'lionsgateportalevents@gmail.com';
  const subject = encodeURIComponent(`Session Confirmation - ${details.hash}`);
  const body = encodeURIComponent(
    `Hello Lions Gate Management,\n\n` +
    `I have completed my payment and confirm my session.\n\n` +
    `Session Details:\n` +
    `- Participant: ${details.participant}\n` +
    `- Scheduled With: ${details.scheduledWith}\n` +
    `- Date & Time: ${details.date} ${details.time}\n` +
    `- Duration: ${details.duration}\n` +
    `- Session Type: ${details.sessionType}\n` +
    `- Payment Amount: $${details.paymentAmount}\n` +
    `- Session Hash: ${details.hash}\n\n` +
    `Thank you,\n` +
    `[Your Name]`
  );
  return `https://mail.google.com/mail/?view=cm&fs=1&to=${to}&su=${subject}&body=${body}`;
}

function buildSessionDetails(hash, tier) {
  const now = new Date();
  const scheduledDate = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000); // +7 days
  return {
    participant: 'Denise',
    scheduledWith: 'Keanu Reeves',
    date: scheduledDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }),
    time: '3:00 PM EST',
    duration: tier.duration,
    sessionType: 'Public (Monitored)',
    paymentAmount: tier.amount,
    privacy: false,
    hash: hash
  };
}

// --- Rendering Functions ---
function renderPricingCards() {
  pricingGrid.innerHTML = '';

  PRICING_TIERS.forEach((tier, index) => {
    const card = document.createElement('button');
    card.className = 'pricing-card' + (tier.featured ? ' featured' : '');
    card.setAttribute('aria-label', `$${tier.amount} - ${tier.duration} - ${tier.desc}`);

    card.innerHTML = `
      ${tier.featured ? '<span class="featured-badge">Popular</span>' : ''}
      <div class="pricing-amount">$${tier.amount}</div>
      <div class="pricing-duration">${tier.duration} live video</div>
      <div class="pricing-desc">${tier.desc}</div>
    `;

    card.addEventListener('click', () => handleTierSelection(tier));
    pricingGrid.appendChild(card);
  });
}

function renderSessionDetails(details) {
  sessionDetailsContainer.innerHTML = `
    <div class="session-details" id="sessionDetailsCard">
      <h4>üìÖ Video Call Session Details</h4>
      <div class="detail-row">
        <span class="detail-label">Participant</span>
        <span class="detail-value">${details.participant}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">Scheduled With</span>
        <span class="detail-value">${details.scheduledWith}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">Date & Time</span>
        <span class="detail-value">${details.date} ‚Ä¢ ${details.time}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">Duration</span>
        <span class="detail-value">${details.duration}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">Session Type</span>
        <span class="detail-value">${details.sessionType}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">Payment Amount</span>
        <span class="detail-value">$${details.paymentAmount}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">Privacy Option</span>
        <span class="detail-value">${details.privacy ? 'Private (Encrypted)' : 'Public (Monitored)'}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">Session Hash</span>
        <span class="detail-value mono">${details.hash}</span>
      </div>
      <div style="margin-top: 24px; display: flex; gap: 12px; flex-wrap: wrap;">
        <button class="btn btn-primary" id="downloadSessionBtn">
          üì• Download as PNG
        </button>
        <button class="btn btn-primary" id="emailConfirmationBtn">
          üìß Email to Management
        </button>
      </div>
    </div>

    <div class="footer-notice">
      ‚ö†Ô∏è <strong>Important Notice:</strong> You have an outstanding balance on your membership registration portal. Kindly contact management for assistance in other forms for this session to be completely approved.
    </div>
  `;

  document.getElementById('downloadSessionBtn').addEventListener('click', () => {
    downloadSessionAsPNG(details);
  });

  document.getElementById('emailConfirmationBtn').addEventListener('click', () => {
    window.open(generateGmailLink(details), '_blank');
  });
}

// --- Event Handlers ---
function handleTierSelection(tier) {
  if (tier.amount !== 120) {
    showErrorModal();
    return;
  }

  show120Modal(tier);
}

function showErrorModal() {
  const modalHTML = `
    <h3>‚ö†Ô∏è Action Required</h3>
    <p>This option requires management assistance for scheduling and payment processing.</p>
    <div class="alert alert-error">
      <span class="alert-icon">‚ùå</span>
      <div>
        <strong>Please contact your management for further assistance when choosing this tier.</strong>
        <br><br>
        Email: <strong>lionsgateportalevents@gmail.com</strong>
      </div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-secondary" id="closeModalBtn" style="width: 100%;">Close</button>
    </div>
  `;

  showModal(modalHTML);
  document.getElementById('closeModalBtn').addEventListener('click', closeModal);
}

function show120Modal(tier) {
  const sessionHash = generateSessionHash();
  APP_STATE.currentHash = sessionHash;

  const modalHTML = `
    <h3>üí≥ $120 ‚Äî 30 seconds</h3>
    <p>${tier.desc}</p>
    <p><strong>Instructions:</strong> Send payment of <strong>$120</strong> to <strong>joancdy@gmail.com</strong> via Zelle. After payment, copy your session hash below and click <em>Confirm</em>.</p>

    <label for="hashField">Session Hash</label>
    <div class="hash-display" id="hashField" tabindex="0" role="button" aria-label="Session hash - click to copy">
      ${sessionHash}
    </div>

    <div id="modalStatus"></div>

    <div class="modal-actions">
      <button class="btn btn-primary" id="confirmBtn">‚úì Confirm Payment</button>
      <button class="btn btn-secondary" id="cancelBtn">‚Üê Go Back</button>
    </div>

    <div id="emailBtnContainer"></div>
  `;

  showModal(modalHTML);

  // Event listeners
  document.getElementById('hashField').addEventListener('click', async () => {
    const success = await copyToClipboard(sessionHash);
    if (success) {
      const statusDiv = document.getElementById('modalStatus');
      statusDiv.innerHTML = `
        <div class="alert alert-success">
          <span class="alert-icon">‚úì</span>
          <div>Session hash copied to clipboard!</div>
        </div>
      `;
      setTimeout(() => {
        statusDiv.innerHTML = '';
      }, 3000);
    }
  });

  document.getElementById('cancelBtn').addEventListener('click', closeModal);
  document.getElementById('confirmBtn').addEventListener('click', () => handleConfirmation(sessionHash, tier));
}

function handleConfirmation(hash, tier) {
  const statusDiv = document.getElementById('modalStatus');
  const confirmBtn = document.getElementById('confirmBtn');

  confirmBtn.disabled = true;
  confirmBtn.textContent = '‚è≥ Processing...';

  statusDiv.innerHTML = `
    <div class="alert alert-success">
      <span class="alert-icon">‚è≥</span>
      <div>Verifying payment and scheduling session...</div>
    </div>
  `;

  setTimeout(() => {
    const sessionDetails = buildSessionDetails(hash, tier);
    APP_STATE.confirmedSession = sessionDetails;

    statusDiv.innerHTML = `
      <div class="alert alert-success">
        <span class="alert-icon">üéâ</span>
        <div><strong>Success!</strong> Payment confirmed. Your session has been scheduled successfully.</div>
      </div>
    `;

    // Render session details in main page
    renderSessionDetails(sessionDetails);

    // Update modal buttons
    confirmBtn.style.display = 'none';
    document.getElementById('cancelBtn').textContent = 'Close';

    // Add email button in modal
    document.getElementById('emailBtnContainer').innerHTML = `
      <div class="modal-actions" style="margin-top: 16px;">
        <button class="btn btn-primary" id="emailManagementBtn" style="width: 100%;">
          üìß Email Management Confirmation
        </button>
      </div>
    `;

    document.getElementById('emailManagementBtn').addEventListener('click', () => {
      window.open(generateGmailLink(sessionDetails), '_blank');
    });
  }, 1800);
}

// --- Download Session as PNG ---
async function downloadSessionAsPNG(details) {
  const btn = document.getElementById('downloadSessionBtn');
  const originalText = btn.innerHTML;
  btn.innerHTML = '‚è≥ Generating PNG...';
  btn.disabled = true;

  try {
    const sessionCard = document.getElementById('sessionDetailsCard');

    // Use html2canvas to capture the element
    const canvas = await html2canvas(sessionCard, {
      backgroundColor: '#1a1f2e',
      scale: 2, // Higher quality
      logging: false,
      useCORS: true
    });

    // Convert to blob and download
    canvas.toBlob((blob) => {
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `LionsGate-Session-${details.hash}.png`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);

      btn.innerHTML = '‚úì Downloaded!';
      setTimeout(() => {
        btn.innerHTML = originalText;
        btn.disabled = false;
      }, 2000);
    });
  } catch (error) {
    console.error('Error generating PNG:', error);
    btn.innerHTML = '‚ùå Error - Try Again';
    setTimeout(() => {
      btn.innerHTML = originalText;
      btn.disabled = false;
    }, 2000);
  }
}

// --- Modal Close on Backdrop Click ---
modalBackdrop.addEventListener('click', (e) => {
  if (e.target === modalBackdrop) {
    closeModal();
  }
});

// --- Keyboard Accessibility ---
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape' && modalBackdrop.classList.contains('active')) {
    closeModal();
  }
});

// --- Initialization ---
document.addEventListener('DOMContentLoaded', () => {
  renderPricingCards();
});
</script>
</body>
</html>
